(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))l(r);new MutationObserver(r=>{for(const s of r)if(s.type==="childList")for(const i of s.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&l(i)}).observe(document,{childList:!0,subtree:!0});function n(r){const s={};return r.integrity&&(s.integrity=r.integrity),r.referrerpolicy&&(s.referrerPolicy=r.referrerpolicy),r.crossorigin==="use-credentials"?s.credentials="include":r.crossorigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function l(r){if(r.ep)return;r.ep=!0;const s=n(r);fetch(r.href,s)}})();function y(){}function Oe(e,t){for(const n in t)e[n]=t[n];return e}function yt(e){return e()}function ut(){return Object.create(null)}function W(e){e.forEach(yt)}function Ue(e){return typeof e=="function"}function X(e,t){return e!=e?t==t:e!==t||e&&typeof e=="object"||typeof e=="function"}let Ee;function ke(e,t){return Ee||(Ee=document.createElement("a")),Ee.href=t,e===Ee.href}function Nt(e){return Object.keys(e).length===0}function wt(e,...t){if(e==null)return y;const n=e.subscribe(...t);return n.unsubscribe?()=>n.unsubscribe():n}function be(e){let t;return wt(e,n=>t=n)(),t}function D(e,t,n){e.$$.on_destroy.push(wt(t,n))}function kt(e,t,n,l){if(e){const r=$t(e,t,n,l);return e[0](r)}}function $t(e,t,n,l){return e[1]&&l?Oe(n.ctx.slice(),e[1](l(t))):n.ctx}function St(e,t,n,l){if(e[2]&&l){const r=e[2](l(n));if(t.dirty===void 0)return r;if(typeof r=="object"){const s=[],i=Math.max(t.dirty.length,r.length);for(let o=0;o<i;o+=1)s[o]=t.dirty[o]|r[o];return s}return t.dirty|r}return t.dirty}function Lt(e,t,n,l,r,s){if(r){const i=$t(t,n,l,s);e.p(i,r)}}function Et(e){if(e.ctx.length>32){const t=[],n=e.ctx.length/32;for(let l=0;l<n;l++)t[l]=-1;return t}return-1}function at(e){const t={};for(const n in e)n[0]!=="$"&&(t[n]=e[n]);return t}function ct(e){return e==null?"":e}function _(e,t){e.appendChild(t)}function C(e,t,n){e.insertBefore(t,n||null)}function S(e){e.parentNode.removeChild(e)}function We(e,t){for(let n=0;n<e.length;n+=1)e[n]&&e[n].d(t)}function h(e){return document.createElement(e)}function $e(e){return document.createTextNode(e)}function b(){return $e(" ")}function E(e,t,n,l){return e.addEventListener(t,n,l),()=>e.removeEventListener(t,n,l)}function ye(e){return function(t){return t.preventDefault(),e.call(this,t)}}function jt(e){return function(t){return t.stopPropagation(),e.call(this,t)}}function d(e,t,n){n==null?e.removeAttribute(t):e.getAttribute(t)!==n&&e.setAttribute(t,n)}function ft(e,t){const n=Object.getOwnPropertyDescriptors(e.__proto__);for(const l in t)t[l]==null?e.removeAttribute(l):l==="style"?e.style.cssText=t[l]:l==="__value"?e.value=e[l]=t[l]:n[l]&&n[l].set?e[l]=t[l]:d(e,l,t[l])}function qt(e){return Array.from(e.childNodes)}function Xe(e,t){t=""+t,e.wholeText!==t&&(e.data=t)}function J(e,t,n){e.classList[n?"add":"remove"](t)}function Mt(e,t,{bubbles:n=!1,cancelable:l=!1}={}){const r=document.createEvent("CustomEvent");return r.initCustomEvent(e,n,l,t),r}let Se;function we(e){Se=e}function ze(){if(!Se)throw new Error("Function called outside component initialization");return Se}function Rt(e){ze().$$.on_mount.push(e)}function Bt(e){ze().$$.after_update.push(e)}function Gt(e){ze().$$.on_destroy.push(e)}function Ct(){const e=ze();return(t,n,{cancelable:l=!1}={})=>{const r=e.$$.callbacks[t];if(r){const s=Mt(t,n,{cancelable:l});return r.slice().forEach(i=>{i.call(e,s)}),!s.defaultPrevented}return!0}}function Ht(e,t){const n=e.$$.callbacks[t.type];n&&n.slice().forEach(l=>l.call(this,t))}const ve=[],_e=[],Ie=[],Be=[],Jt=Promise.resolve();let Ge=!1;function Ut(){Ge||(Ge=!0,Jt.then(It))}function He(e){Ie.push(e)}function je(e){Be.push(e)}const qe=new Set;let Ce=0;function It(){const e=Se;do{for(;Ce<ve.length;){const t=ve[Ce];Ce++,we(t),Wt(t.$$)}for(we(null),ve.length=0,Ce=0;_e.length;)_e.pop()();for(let t=0;t<Ie.length;t+=1){const n=Ie[t];qe.has(n)||(qe.add(n),n())}Ie.length=0}while(ve.length);for(;Be.length;)Be.pop()();Ge=!1,qe.clear(),we(e)}function Wt(e){if(e.fragment!==null){e.update(),W(e.before_update);const t=e.dirty;e.dirty=[-1],e.fragment&&e.fragment.p(e.ctx,t),e.after_update.forEach(He)}}const Te=new Set;let le;function Ye(){le={r:0,c:[],p:le}}function Fe(){le.r||W(le.c),le=le.p}function k(e,t){e&&e.i&&(Te.delete(e),e.i(t))}function I(e,t,n,l){if(e&&e.o){if(Te.has(e))return;Te.add(e),le.c.push(()=>{Te.delete(e),l&&(n&&e.d(1),l())}),e.o(t)}else l&&l()}function Xt(e,t){const n={},l={},r={$$scope:1};let s=e.length;for(;s--;){const i=e[s],o=t[s];if(o){for(const u in i)u in o||(l[u]=1);for(const u in o)r[u]||(n[u]=o[u],r[u]=1);e[s]=o}else for(const u in i)r[u]=1}for(const i in l)i in n||(n[i]=void 0);return n}function Me(e,t,n){const l=e.$$.props[t];l!==void 0&&(e.$$.bound[l]=n,n(e.$$.ctx[l]))}function B(e){e&&e.c()}function M(e,t,n,l){const{fragment:r,after_update:s}=e.$$;r&&r.m(t,n),l||He(()=>{const i=e.$$.on_mount.map(yt).filter(Ue);e.$$.on_destroy?e.$$.on_destroy.push(...i):W(i),e.$$.on_mount=[]}),s.forEach(He)}function R(e,t){const n=e.$$;n.fragment!==null&&(W(n.on_destroy),n.fragment&&n.fragment.d(t),n.on_destroy=n.fragment=null,n.ctx=[])}function Yt(e,t){e.$$.dirty[0]===-1&&(ve.push(e),Ut(),e.$$.dirty.fill(0)),e.$$.dirty[t/31|0]|=1<<t%31}function Q(e,t,n,l,r,s,i,o=[-1]){const u=Se;we(e);const a=e.$$={fragment:null,ctx:[],props:s,update:y,not_equal:r,bound:ut(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(t.context||(u?u.$$.context:[])),callbacks:ut(),dirty:o,skip_bound:!1,root:t.target||u.$$.root};i&&i(a.root);let c=!1;if(a.ctx=n?n(e,t.props||{},(f,g,...$)=>{const w=$.length?$[0]:g;return a.ctx&&r(a.ctx[f],a.ctx[f]=w)&&(!a.skip_bound&&a.bound[f]&&a.bound[f](w),c&&Yt(e,f)),g}):[],a.update(),c=!0,W(a.before_update),a.fragment=l?l(a.ctx):!1,t.target){if(t.hydrate){const f=qt(t.target);a.fragment&&a.fragment.l(f),f.forEach(S)}else a.fragment&&a.fragment.c();t.intro&&k(e.$$.fragment),M(e,t.target,t.anchor,t.customElement),It()}we(u)}class V{$destroy(){R(this,1),this.$destroy=y}$on(t,n){if(!Ue(n))return y;const l=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return l.push(n),()=>{const r=l.indexOf(n);r!==-1&&l.splice(r,1)}}$set(t){this.$$set&&!Nt(t)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}function Ft(e){let t,n,l,r,s,i,o,u=[{type:e[3]},{name:e[2]},{id:e[2]},e[4],{value:e[0]}],a={};for(let c=0;c<u.length;c+=1)a=Oe(a,u[c]);return{c(){t=h("div"),n=h("label"),l=$e(e[1]),r=b(),s=h("input"),d(n,"for",e[2]),ft(s,a)},m(c,f){C(c,t,f),_(t,n),_(n,l),_(t,r),_(t,s),s.value=a.value,s.autofocus&&s.focus(),i||(o=[E(s,"input",e[5]),E(s,"keypress",e[6])],i=!0)},p(c,[f]){f&2&&Xe(l,c[1]),f&4&&d(n,"for",c[2]),ft(s,a=Xt(u,[f&8&&{type:c[3]},f&4&&{name:c[2]},f&4&&{id:c[2]},f&16&&c[4],f&1&&s.value!==c[0]&&{value:c[0]}])),"value"in a&&(s.value=a.value)},i:y,o:y,d(c){c&&S(t),i=!1,W(o)}}}function Kt(e,t,n){let{value:l=""}=t,{label:r="Input"}=t,{name:s="input"}=t,{type:i="text"}=t,{inputParams:o={}}=t;const u=Ct(),a=f=>{n(0,l=f.target.value),i==="number"||i==="range"?n(0,l=Number(l)):i=="checkbox"&&n(0,l=f.target.checked),u("input",l)};function c(f){Ht.call(this,e,f)}return e.$$set=f=>{"value"in f&&n(0,l=f.value),"label"in f&&n(1,r=f.label),"name"in f&&n(2,s=f.name),"type"in f&&n(3,i=f.type),"inputParams"in f&&n(4,o=f.inputParams)},[l,r,s,i,o,a,c]}class Re extends V{constructor(t){super(),Q(this,t,Kt,Ft,X,{value:0,label:1,name:2,type:3,inputParams:4})}}function Qt(e){let t,n,l,r,s,i,o,u;const a=e[4].default,c=kt(a,e,e[3],null);return{c(){t=h("nav"),n=h("h2"),l=$e(e[0]),r=b(),s=h("hr"),i=b(),c&&c.c(),d(n,"class","svelte-15oiif1"),d(s,"class","svelte-15oiif1"),d(t,"class",o=ct(e[2].class)+" svelte-15oiif1"),J(t,"leftShadow",e[1]=="left"),J(t,"rightShadow",e[1]=="right")},m(f,g){C(f,t,g),_(t,n),_(n,l),_(t,r),_(t,s),_(t,i),c&&c.m(t,null),u=!0},p(f,[g]){(!u||g&1)&&Xe(l,f[0]),c&&c.p&&(!u||g&8)&&Lt(c,a,f,f[3],u?St(a,f[3],g,null):Et(f[3]),null),(!u||g&4&&o!==(o=ct(f[2].class)+" svelte-15oiif1"))&&d(t,"class",o),(!u||g&6)&&J(t,"leftShadow",f[1]=="left"),(!u||g&6)&&J(t,"rightShadow",f[1]=="right")},i(f){u||(k(c,f),u=!0)},o(f){I(c,f),u=!1},d(f){f&&S(t),c&&c.d(f)}}}function Vt(e,t,n){let{$$slots:l={},$$scope:r}=t,{title:s="Undefined"}=t,{shadow:i="left"}=t;return e.$$set=o=>{n(2,t=Oe(Oe({},t),at(o))),"title"in o&&n(0,s=o.title),"shadow"in o&&n(1,i=o.shadow),"$$scope"in o&&n(3,r=o.$$scope)},t=at(t),[s,i,t,r,l]}class Tt extends V{constructor(t){super(),Q(this,t,Vt,Qt,X,{title:0,shadow:1})}}const de=[];function he(e,t=y){let n;const l=new Set;function r(o){if(X(e,o)&&(e=o,n)){const u=!de.length;for(const a of l)a[1](),de.push(a,e);if(u){for(let a=0;a<de.length;a+=2)de[a][0](de[a+1]);de.length=0}}}function s(o){r(o(e))}function i(o,u=y){const a=[o,u];return l.add(a),l.size===1&&(n=t(r)||y),o(e),()=>{l.delete(a),l.size===0&&(n(),n=null)}}return{set:r,update:s,subscribe:i}}const ne=he(-1),Je=he(!1);function At(e,t,n){const{subscribe:l,set:r,update:s}=he(e);return{subscribe:l,set(i){i<t?i=t:i>n&&(i=n),r(i)},update(i){s(o=>(o=i(o),o<t?o=t:o>n&&(o=n),o))}}}const Le=At(10,1,50),ge=At(10,1,20);function Zt(){const{subscribe:e,set:t,update:n}=he(new Array);return{subscribe:e,set:t,addLevel(){n(l=>[...l,Array.from({length:be(ge)*2+1},r=>Array(be(Le)).fill(-1))])},pushLevel(l,r){n(r===void 0?s=>[...s,l]:s=>(s=[...s.slice(0,r),l,...s.slice(r)],s))},removeLevel(l){n(r=>(r=r.filter((s,i)=>i!==l),r))},setLevelCell(l,r,s,i){s!=be(ge)&&n(o=>(o[l][s][r]=i,o))},resize(l,r){r=r*2+1,n(s=>s.map(i=>{const o=i.length-r;if(o>0)i=i.slice(o/2,i.length-o/2);else if(o<0){for(let u=0;u<-o/2;u++)i.unshift(Array(l).fill(-1));for(let u=0;u<-o/2;u++)i.push(Array(l).fill(-1))}return i=i.map(u=>(u.length>l?u=u.slice(0,l):u.length<l&&(u=[...u,...Array(l-u.length).fill(-1)]),u)),i}))},reset(){n(l=>new Array)}}}const P=Zt(),dt=localStorage.getItem("levels");if(dt){const e=JSON.parse(dt);P.set(e.levels),Le.set(e.width),ge.set(e.height)}P.subscribe(e=>{localStorage.setItem("levels",JSON.stringify({width:be(Le),height:be(ge),levels:e}))});const re=he(Array()),_t=localStorage.getItem("images");if(_t){const e=JSON.parse(_t);re.update(t=>[...t,...e.map(n=>{const l=new Image;return l.src=n.data,{name:n.name,data:l}})])}re.subscribe(e=>{localStorage.setItem("images",JSON.stringify(e.map(t=>({name:t.name,data:t.data.src}))))});const Ae=he(-1),xt="/Vivian-level-editor/assets/trash.8b6cb216.svg",en=(e,t,n)=>{const l=document.createElement("canvas"),r=l.getContext("2d");if(!r)throw new Error("Canvas context is not defined");l.width=t,l.height=n,r.imageSmoothingEnabled=!0,r.imageSmoothingQuality="high",r.drawImage(e,0,0,t,n);const s=new Image;return s.src=l.toDataURL(),s.alt=e.alt,s.title=e.title,console.log(e),console.log(s),s};function gt(e,t,n){const l=e.slice();return l[21]=t[n],l[23]=n,l}function ht(e){let t,n,l,r,s,i,o,u,a,c;return{c(){t=h("li"),n=h("input"),l=b(),r=h("label"),s=h("img"),d(n,"type","radio"),d(n,"name","tile"+String(e[23])),d(n,"id","tile"+String(e[23])),n.__value=e[23],n.value=n.__value,d(n,"class","svelte-1br2yg2"),e[18][0].push(n),ke(s.src,i=e[21].data.src)||d(s,"src",i),d(s,"alt",o=e[21].name),d(s,"title",u=e[21].name),d(s,"draggable","false"),d(s,"class","svelte-1br2yg2"),d(r,"for","tile"+String(e[23])),d(r,"class","svelte-1br2yg2"),J(r,"current",e[6]==e[23]),d(t,"class","tileSelector__itemList__tile svelte-1br2yg2"),d(t,"draggable","true"),d(t,"data-id",e[23]),J(t,"hidden",e[1]==e[23])},m(f,g){C(f,t,g),_(t,n),n.checked=n.__value===e[6],_(t,l),_(t,r),_(r,s),a||(c=[E(n,"change",e[19]),E(t,"dragstart",e[11]),E(t,"dragover",ye(e[12])),E(t,"dragend",e[13])],a=!0)},p(f,g){g&64&&(n.checked=n.__value===f[6]),g&4&&!ke(s.src,i=f[21].data.src)&&d(s,"src",i),g&4&&o!==(o=f[21].name)&&d(s,"alt",o),g&4&&u!==(u=f[21].name)&&d(s,"title",u),g&64&&J(r,"current",f[6]==f[23]),g&2&&J(t,"hidden",f[1]==f[23])},d(f){f&&S(t),e[18][0].splice(e[18][0].indexOf(n),1),a=!1,W(c)}}}function tn(e){let t,n,l,r,s,i,o,u,a,c,f,g,$,w,Z,se,z,p,Y,N,x,j,ie,v,L,T,G,F,pe,Ke,De,Qe,U,oe,A,Ve,ee,te,Ze,xe,Pe,ue,K,et,me,ae,Ne,tt;function zt(m){e[14](m)}let nt={label:"Width:",name:"width",type:"number",inputParams:{min:0,max:100,step:1}};e[4]!==void 0&&(nt.value=e[4]),w=new Re({props:nt}),_e.push(()=>Me(w,"value",zt)),w.$on("keypress",e[8]);function Dt(m){e[15](m)}let lt={label:"Height:",name:"height",type:"number",inputParams:{min:0,max:100,step:1}};e[3]!==void 0&&(lt.value=e[3]),z=new Re({props:lt}),_e.push(()=>Me(z,"value",Dt)),z.$on("keypress",e[8]);function Pt(m){e[16](m)}let rt={label:"Horizontal mirror:",name:"mirror",type:"checkbox",inputParams:{checked:!1}};e[5]!==void 0&&(rt.value=e[5]),L=new Re({props:rt}),_e.push(()=>Me(L,"value",Pt));let ce=e[2],O=[];for(let m=0;m<ce.length;m+=1)O[m]=ht(gt(e,ce,m));return{c(){t=h("form"),n=h("div"),l=h("h3"),l.textContent="Project Manager",r=b(),s=h("button"),s.textContent="Import level set",i=b(),o=h("button"),o.textContent="Export level set",u=b(),a=h("button"),a.textContent="Delete current project",c=b(),f=h("div"),g=h("h3"),g.textContent="Grid Size",$=b(),B(w.$$.fragment),se=b(),B(z.$$.fragment),Y=b(),N=h("button"),N.textContent="Resize",x=b(),j=h("div"),ie=h("h3"),ie.textContent="Mirror",v=b(),B(L.$$.fragment),G=b(),F=h("div"),pe=h("h3"),Ke=$e("Tile selector : "),De=$e(e[6]),Qe=b(),U=h("ul"),oe=h("li"),A=h("input"),Ve=b(),ee=h("label"),te=h("img"),xe=b();for(let m=0;m<O.length;m+=1)O[m].c();Pe=b(),ue=h("li"),K=h("input"),et=b(),me=h("label"),me.textContent="+",d(l,"class","svelte-1br2yg2"),d(s,"class","svelte-1br2yg2"),d(o,"class","svelte-1br2yg2"),d(a,"class","warn svelte-1br2yg2"),d(n,"class","fileManager svelte-1br2yg2"),d(g,"class","svelte-1br2yg2"),d(N,"class","svelte-1br2yg2"),d(f,"class","gridSize svelte-1br2yg2"),d(ie,"class","svelte-1br2yg2"),d(j,"class","mirror"),d(pe,"class","svelte-1br2yg2"),d(A,"type","radio"),d(A,"name","tileEraser"),d(A,"id","tileEraser"),A.__value=-1,A.value=A.__value,d(A,"class","svelte-1br2yg2"),e[18][0].push(A),ke(te.src,Ze=xt)||d(te,"src",Ze),d(te,"alt","Eraser"),d(te,"title","Eraser"),d(te,"class","svelte-1br2yg2"),d(ee,"for","tileEraser"),d(ee,"class","noBg svelte-1br2yg2"),J(ee,"current",e[6]==-1),d(oe,"class","tileSelector__itemList__tile svelte-1br2yg2"),d(K,"type","file"),d(K,"id","newTileButton"),d(K,"accept","*.png, *.jpg, *.jpeg"),d(K,"class","svelte-1br2yg2"),d(me,"for","newTileButton"),d(me,"class","noBg svelte-1br2yg2"),d(ue,"class","tileSelector__itemList__tile svelte-1br2yg2"),d(U,"class","tileSelector__itemList svelte-1br2yg2"),d(F,"class","tileSelector"),d(t,"class","svelte-1br2yg2")},m(m,H){C(m,t,H),_(t,n),_(n,l),_(n,r),_(n,s),_(n,i),_(n,o),_(n,u),_(n,a),_(t,c),_(t,f),_(f,g),_(f,$),M(w,f,null),_(f,se),M(z,f,null),_(f,Y),_(f,N),_(t,x),_(t,j),_(j,ie),_(j,v),M(L,j,null),_(t,G),_(t,F),_(F,pe),_(pe,Ke),_(pe,De),_(F,Qe),_(F,U),_(U,oe),_(oe,A),A.checked=A.__value===e[6],_(oe,Ve),_(oe,ee),_(ee,te),_(U,xe);for(let fe=0;fe<O.length;fe+=1)O[fe].m(U,null);_(U,Pe),_(U,ue),_(ue,K),_(ue,et),_(ue,me),ae=!0,Ne||(tt=[E(a,"click",ye(e[10])),E(N,"click",ye(e[9])),E(A,"change",e[17]),E(K,"change",e[20]),E(K,"change",ye(e[7]))],Ne=!0)},p(m,H){const fe={};!Z&&H&16&&(Z=!0,fe.value=m[4],je(()=>Z=!1)),w.$set(fe);const st={};!p&&H&8&&(p=!0,st.value=m[3],je(()=>p=!1)),z.$set(st);const it={};if(!T&&H&32&&(T=!0,it.value=m[5],je(()=>T=!1)),L.$set(it),(!ae||H&64)&&Xe(De,m[6]),H&64&&(A.checked=A.__value===m[6]),(!ae||H&64)&&J(ee,"current",m[6]==-1),H&14406){ce=m[2];let q;for(q=0;q<ce.length;q+=1){const ot=gt(m,ce,q);O[q]?O[q].p(ot,H):(O[q]=ht(ot),O[q].c(),O[q].m(U,Pe))}for(;q<O.length;q+=1)O[q].d(1);O.length=ce.length}},i(m){ae||(k(w.$$.fragment,m),k(z.$$.fragment,m),k(L.$$.fragment,m),ae=!0)},o(m){I(w.$$.fragment,m),I(z.$$.fragment,m),I(L.$$.fragment,m),ae=!1},d(m){m&&S(t),R(w),R(z),R(L),e[18][0].splice(e[18][0].indexOf(A),1),We(O,m),Ne=!1,W(tt)}}}function nn(e){let t,n;return t=new Tt({props:{title:"Configuration",shadow:"right",$$slots:{default:[tn]},$$scope:{ctx:e}}}),{c(){B(t.$$.fragment)},m(l,r){M(t,l,r),n=!0},p(l,[r]){const s={};r&16777343&&(s.$$scope={dirty:r,ctx:l}),t.$set(s)},i(l){n||(k(t.$$.fragment,l),n=!0)},o(l){I(t.$$.fragment,l),n=!1},d(l){R(t,l)}}}function ln(e,t,n){let l,r,s,i,o;D(e,re,v=>n(2,l=v)),D(e,ge,v=>n(3,r=v)),D(e,Le,v=>n(4,s=v)),D(e,Je,v=>n(5,i=v)),D(e,Ae,v=>n(6,o=v));let u,a=-1;const c=()=>{let v=u[0],L=new FileReader;L.onload=()=>{const T=new Image;T.onload=()=>{re.update(G=>[...G,{name:v.name,data:en(T,32,32)}])},T.src=L.result,T.title=v.name,T.alt=v.name+" tile"},L.readAsDataURL(v)},f=v=>{v.key==="Enter"&&(g(),v.preventDefault())},g=()=>{P.resize(s,r)},$=()=>{confirm("Are you sure you want to delete this project?")&&(P.reset(),re.set([]))},w=v=>{const L=v.target,T=parseInt(L.getAttribute("data-id"));v.dataTransfer.setDragImage(l[T].data,16,16),v.dataTransfer.dropEffect="copy",setTimeout(()=>{n(1,a=T)},0)},Z=v=>{if(a==-1)return;let L=v.target;for(;!L.classList.contains("tileSelector__itemList__tile");)L=L.parentElement;const T=parseInt(L.getAttribute("data-id"));T!=a&&(re.update(G=>{const F=G[a];return G[a]=G[T],G[T]=F,G}),n(1,a=T))},se=()=>{n(1,a=-1)},z=[[]];function p(v){s=v,Le.set(s)}function Y(v){r=v,ge.set(r)}function N(v){i=v,Je.set(i)}function x(){o=this.__value,Ae.set(o)}function j(){o=this.__value,Ae.set(o)}function ie(){u=this.files,n(0,u)}return[u,a,l,r,s,i,o,c,f,g,$,w,Z,se,p,Y,N,x,z,j,ie]}class rn extends V{constructor(t){super(),Q(this,t,ln,nn,X,{})}}function sn(e){let t,n,l,r,s,i;return{c(){t=h("div"),n=h("canvas"),d(n,"width",l=e[1]*32),d(n,"height",r=e[2]*32),d(t,"class","grid svelte-2utg53")},m(o,u){C(o,t,u),_(t,n),e[9](n),s||(i=[E(window,"resize",e[3]),E(n,"mousedown",ye(e[4])),E(n,"mousemove",e[6]),E(n,"contextmenu",e[5])],s=!0)},p(o,[u]){u&2&&l!==(l=o[1]*32)&&d(n,"width",l),u&4&&r!==(r=o[2]*32)&&d(n,"height",r)},i:y,o:y,d(o){o&&S(t),e[9](null),s=!1,W(i)}}}function on(e,t,n){let l,r;D(e,P,p=>n(8,l=p)),D(e,re,p=>n(11,r=p));let{gridId:s}=t,i,o=null,u,a;const c=()=>{if(o==null)return;o.clearRect(0,0,i.width,i.height);let p=Math.floor(l[s].length/2);l[s].forEach((Y,N)=>{Y.forEach((x,j)=>{N==p?(o.fillStyle="black",o.fillRect(j*32,N*32,32,32)):x===-1?(o.fillStyle="white",o.fillRect(j*32,N*32,32,32)):o.drawImage(r[x].data,j*32,N*32,32,32)})})},f=()=>{if(o!=null){c(),o.beginPath(),o.strokeStyle="black",o.fillStyle="black",o.lineWidth=1;for(let p=0;p<u;p++)o.moveTo(p*32,0),o.lineTo(p*32,a*32);for(let p=0;p<a;p++)o.moveTo(0,p*32),o.lineTo(u*32,p*32);o.stroke()}},g=(p,Y)=>({x:Math.floor(p/i.width*u),y:Math.floor(Y/i.height*a)}),$=Ct(),w=p=>{if(p.buttons==2&&!p.shiftKey)return $("erase",g(p.offsetX,p.offsetY)),!1;if(p.buttons==1)return $("click",g(p.offsetX,p.offsetY)),!0},Z=p=>{if(!p.shiftKey){p.preventDefault(),w(p);return}},se=p=>{p.buttons==2?$("erase",g(p.offsetX,p.offsetY)):p.buttons==1&&$("click",g(p.offsetX,p.offsetY))};Rt(()=>{if(o=i.getContext("2d"),o==null){alert("Could not get canvas context");return}o.imageSmoothingEnabled=!0,console.log("Context loaded"),s>-1&&f()}),Gt(()=>{o=null}),Bt(()=>{s>-1&&f()});function z(p){_e[p?"unshift":"push"](()=>{i=p,n(0,i)})}return e.$$set=p=>{"gridId"in p&&n(7,s=p.gridId)},e.$$.update=()=>{e.$$.dirty&384&&s>-1&&s<l.length&&(n(1,u=l[s][0].length),n(2,a=l[s].length)),e.$$.dirty&384&&l[s]&&f()},[i,u,a,f,w,Z,se,s,l,z]}class Ot extends V{constructor(t){super(),Q(this,t,on,sn,X,{gridId:7})}}function un(e){let t;return{c(){t=h("p"),t.textContent="There is currently no level selected.",d(t,"class","center svelte-10pwihz")},m(n,l){C(n,t,l)},p:y,i:y,o:y,d(n){n&&S(t)}}}function an(e){let t,n,l,r,s,i;return{c(){t=h("div"),n=h("p"),n.textContent="There is currently no levels.",l=b(),r=h("button"),r.textContent="Add a new level",d(t,"class","center svelte-10pwihz")},m(o,u){C(o,t,u),_(t,n),_(t,l),_(t,r),s||(i=E(r,"click",e[2]),s=!0)},p:y,i:y,o:y,d(o){o&&S(t),s=!1,i()}}}function cn(e){let t,n;return t=new Ot({props:{gridId:e[0]}}),t.$on("click",e[3]),t.$on("erase",e[4]),{c(){B(t.$$.fragment)},m(l,r){M(t,l,r),n=!0},p(l,r){const s={};r&1&&(s.gridId=l[0]),t.$set(s)},i(l){n||(k(t.$$.fragment,l),n=!0)},o(l){I(t.$$.fragment,l),n=!1},d(l){R(t,l)}}}function fn(e){let t,n,l,r;const s=[cn,an,un],i=[];function o(u,a){return u[0]!=-1&&u[1].length>0?0:u[1].length==0?1:2}return n=o(e),l=i[n]=s[n](e),{c(){t=h("section"),l.c(),d(t,"class","editor svelte-10pwihz")},m(u,a){C(u,t,a),i[n].m(t,null),r=!0},p(u,[a]){let c=n;n=o(u),n===c?i[n].p(u,a):(Ye(),I(i[c],1,1,()=>{i[c]=null}),Fe(),l=i[n],l?l.p(u,a):(l=i[n]=s[n](u),l.c()),k(l,1),l.m(t,null))},i(u){r||(k(l),r=!0)},o(u){I(l),r=!1},d(u){u&&S(t),i[n].d()}}}function dn(e,t,n){let l,r,s,i;D(e,Ae,c=>n(5,l=c)),D(e,ne,c=>n(0,r=c)),D(e,P,c=>n(1,s=c)),D(e,Je,c=>n(6,i=c));const o=()=>{P.addLevel(),ne.set(s.length-1)},u=(c,f=!1)=>{P.setLevelCell(r,c.detail.x,c.detail.y,f?-1:l),i&&P.setLevelCell(r,c.detail.x,s[r].length-c.detail.y-1,f?-1:l)};return[r,s,o,u,c=>{u(c,!0)}]}class _n extends V{constructor(t){super(),Q(this,t,dn,fn,X,{})}}const gn="/Vivian-level-editor/assets/trash-white.330e363c.svg",hn="/Vivian-level-editor/assets/copy-white.e7560aad.svg";function pt(e,t,n){const l=e.slice();return l[4]=t[n],l}function mt(e){let t,n,l,r,s,i,o,u;return{c(){t=h("button"),n=h("img"),s=b(),ke(n.src,l=e[4].icon)||d(n,"src",l),d(n,"alt",r=e[4].title+"button"),d(n,"class","svelte-1yu8awl"),d(t,"title",i=e[4].title),d(t,"class","svelte-1yu8awl")},m(a,c){C(a,t,c),_(t,n),_(t,s),o||(u=E(t,"click",jt(function(){Ue(e[4].action(e[1]))&&e[4].action(e[1]).apply(this,arguments)})),o=!0)},p(a,c){e=a,c&1&&!ke(n.src,l=e[4].icon)&&d(n,"src",l),c&1&&r!==(r=e[4].title+"button")&&d(n,"alt",r),c&1&&i!==(i=e[4].title)&&d(t,"title",i)},d(a){a&&S(t),o=!1,u()}}}function pn(e){let t,n,l,r,s=e[0],i=[];for(let a=0;a<s.length;a+=1)i[a]=mt(pt(e,s,a));const o=e[3].default,u=kt(o,e,e[2],null);return{c(){t=h("div"),n=h("div");for(let a=0;a<i.length;a+=1)i[a].c();l=b(),u&&u.c(),d(n,"class","buttons svelte-1yu8awl"),d(t,"class","overlay svelte-1yu8awl")},m(a,c){C(a,t,c),_(t,n);for(let f=0;f<i.length;f+=1)i[f].m(n,null);_(t,l),u&&u.m(t,null),r=!0},p(a,[c]){if(c&3){s=a[0];let f;for(f=0;f<s.length;f+=1){const g=pt(a,s,f);i[f]?i[f].p(g,c):(i[f]=mt(g),i[f].c(),i[f].m(n,null))}for(;f<i.length;f+=1)i[f].d(1);i.length=s.length}u&&u.p&&(!r||c&4)&&Lt(u,o,a,a[2],r?St(o,a[2],c,null):Et(a[2]),null)},i(a){r||(k(u,a),r=!0)},o(a){I(u,a),r=!1},d(a){a&&S(t),We(i,a),u&&u.d(a)}}}function mn(e,t,n){let{$$slots:l={},$$scope:r}=t,{buttons:s}=t,{childId:i}=t;return e.$$set=o=>{"buttons"in o&&n(0,s=o.buttons),"childId"in o&&n(1,i=o.childId),"$$scope"in o&&n(2,r=o.$$scope)},[s,i,r,l]}class vn extends V{constructor(t){super(),Q(this,t,mn,pn,X,{buttons:0,childId:1})}}function vt(e,t,n){const l=e.slice();return l[6]=t[n],l[8]=n,l}function bn(e){let t;return{c(){t=h("p"),t.textContent="There is currently no levels."},m(n,l){C(n,t,l)},p:y,i:y,o:y,d(n){n&&S(t)}}}function yn(e){let t,n,l=e[1],r=[];for(let i=0;i<l.length;i+=1)r[i]=bt(vt(e,l,i));const s=i=>I(r[i],1,1,()=>{r[i]=null});return{c(){t=h("ul");for(let i=0;i<r.length;i+=1)r[i].c();d(t,"class","levelList__list svelte-ynwbqm")},m(i,o){C(i,t,o);for(let u=0;u<r.length;u+=1)r[u].m(t,null);n=!0},p(i,o){if(o&7){l=i[1];let u;for(u=0;u<l.length;u+=1){const a=vt(i,l,u);r[u]?(r[u].p(a,o),k(r[u],1)):(r[u]=bt(a),r[u].c(),k(r[u],1),r[u].m(t,null))}for(Ye(),u=l.length;u<r.length;u+=1)s(u);Fe()}},i(i){if(!n){for(let o=0;o<l.length;o+=1)k(r[o]);n=!0}},o(i){r=r.filter(Boolean);for(let o=0;o<r.length;o+=1)I(r[o]);n=!1},d(i){i&&S(t),We(r,i)}}}function wn(e){let t,n;return t=new Ot({props:{gridId:e[8]}}),{c(){B(t.$$.fragment)},m(l,r){M(t,l,r),n=!0},p:y,i(l){n||(k(t.$$.fragment,l),n=!0)},o(l){I(t.$$.fragment,l),n=!1},d(l){R(t,l)}}}function bt(e){let t,n,l,r,s,i,o,u,a;return s=new vn({props:{buttons:e[2],childId:e[8],$$slots:{default:[wn]},$$scope:{ctx:e}}}),{c(){t=h("li"),n=h("input"),l=b(),r=h("label"),B(s.$$.fragment),i=b(),d(n,"type","radio"),d(n,"name","level"),d(n,"id","level-"+e[8]),n.__value=e[8],n.value=n.__value,d(n,"class","svelte-ynwbqm"),e[5][0].push(n),d(r,"class","levelList__list__grid svelte-ynwbqm"),d(r,"for","level-"+e[8]),d(t,"class","svelte-ynwbqm")},m(c,f){C(c,t,f),_(t,n),n.checked=n.__value===e[0],_(t,l),_(t,r),M(s,r,null),_(t,i),o=!0,u||(a=E(n,"change",e[4]),u=!0)},p(c,f){f&1&&(n.checked=n.__value===c[0]);const g={};f&512&&(g.$$scope={dirty:f,ctx:c}),s.$set(g)},i(c){o||(k(s.$$.fragment,c),o=!0)},o(c){I(s.$$.fragment,c),o=!1},d(c){c&&S(t),e[5][0].splice(e[5][0].indexOf(n),1),R(s),u=!1,a()}}}function kn(e){let t,n,l,r,s,i,o,u;const a=[yn,bn],c=[];function f(g,$){return g[1].length!=0?0:1}return r=f(e),s=c[r]=a[r](e),{c(){t=h("button"),t.textContent="Add a new level",n=b(),l=h("div"),s.c(),d(t,"class","svelte-ynwbqm"),d(l,"class","levelList svelte-ynwbqm")},m(g,$){C(g,t,$),C(g,n,$),C(g,l,$),c[r].m(l,null),i=!0,o||(u=E(t,"click",e[3]),o=!0)},p(g,$){let w=r;r=f(g),r===w?c[r].p(g,$):(Ye(),I(c[w],1,1,()=>{c[w]=null}),Fe(),s=c[r],s?s.p(g,$):(s=c[r]=a[r](g),s.c()),k(s,1),s.m(l,null))},i(g){i||(k(s),i=!0)},o(g){I(s),i=!1},d(g){g&&S(t),g&&S(n),g&&S(l),c[r].d(),o=!1,u()}}}function $n(e){let t,n;return t=new Tt({props:{title:"Level Selector",shadow:"left",$$slots:{default:[kn]},$$scope:{ctx:e}}}),{c(){B(t.$$.fragment)},m(l,r){M(t,l,r),n=!0},p(l,[r]){const s={};r&515&&(s.$$scope={dirty:r,ctx:l}),t.$set(s)},i(l){n||(k(t.$$.fragment,l),n=!0)},o(l){I(t.$$.fragment,l),n=!1},d(l){R(t,l)}}}function Sn(e,t,n){let l,r;D(e,ne,a=>n(0,l=a)),D(e,P,a=>n(1,r=a));const s=[{title:"Duplicate Level",icon:hn,action:a=>(P.pushLevel(r[a].map(c=>[...c]),a+1),ne.update(c=>a+1),null)},{title:"Delete Level",icon:gn,action:a=>(l==a?ne.set(-1):ne.update(c=>c>a?c-1:c),P.removeLevel(a),null)}],i=a=>{P.addLevel()},o=[[]];function u(){l=this.__value,ne.set(l)}return[l,r,s,i,u,o]}class Ln extends V{constructor(t){super(),Q(this,t,Sn,$n,X,{})}}function En(e){let t,n,l,r,s,i,o,u,a;return r=new rn({}),i=new _n({}),u=new Ln({}),{c(){t=h("header"),t.innerHTML="<h1>Vivian level Editor</h1>",n=b(),l=h("main"),B(r.$$.fragment),s=b(),B(i.$$.fragment),o=b(),B(u.$$.fragment),d(l,"class","svelte-1fszlhy")},m(c,f){C(c,t,f),C(c,n,f),C(c,l,f),M(r,l,null),_(l,s),M(i,l,null),_(l,o),M(u,l,null),a=!0},p:y,i(c){a||(k(r.$$.fragment,c),k(i.$$.fragment,c),k(u.$$.fragment,c),a=!0)},o(c){I(r.$$.fragment,c),I(i.$$.fragment,c),I(u.$$.fragment,c),a=!1},d(c){c&&S(t),c&&S(n),c&&S(l),R(r),R(i),R(u)}}}class Cn extends V{constructor(t){super(),Q(this,t,null,En,X,{})}}new Cn({target:document.getElementById("app")});
