(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))l(r);new MutationObserver(r=>{for(const s of r)if(s.type==="childList")for(const i of s.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&l(i)}).observe(document,{childList:!0,subtree:!0});function n(r){const s={};return r.integrity&&(s.integrity=r.integrity),r.referrerpolicy&&(s.referrerPolicy=r.referrerpolicy),r.crossorigin==="use-credentials"?s.credentials="include":r.crossorigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function l(r){if(r.ep)return;r.ep=!0;const s=n(r);fetch(r.href,s)}})();function y(){}function $e(e,t){for(const n in t)e[n]=t[n];return e}function ot(e){return e()}function Ke(){return Object.create(null)}function J(e){e.forEach(ot)}function ut(e){return typeof e=="function"}function W(e,t){return e!=e?t==t:e!==t||e&&typeof e=="object"||typeof e=="function"}let pe;function Ae(e,t){return pe||(pe=document.createElement("a")),pe.href=t,e===pe.href}function bt(e){return Object.keys(e).length===0}function ct(e,...t){if(e==null)return y;const n=e.subscribe(...t);return n.unsubscribe?()=>n.unsubscribe():n}function ae(e){let t;return ct(e,n=>t=n)(),t}function j(e,t,n){e.$$.on_destroy.push(ct(t,n))}function yt(e,t,n,l){if(e){const r=at(e,t,n,l);return e[0](r)}}function at(e,t,n,l){return e[1]&&l?$e(n.ctx.slice(),e[1](l(t))):n.ctx}function wt(e,t,n,l){if(e[2]&&l){const r=e[2](l(n));if(t.dirty===void 0)return r;if(typeof r=="object"){const s=[],i=Math.max(t.dirty.length,r.length);for(let u=0;u<i;u+=1)s[u]=t.dirty[u]|r[u];return s}return t.dirty|r}return t.dirty}function kt(e,t,n,l,r,s){if(r){const i=at(t,n,l,s);e.p(i,r)}}function $t(e){if(e.ctx.length>32){const t=[],n=e.ctx.length/32;for(let l=0;l<n;l++)t[l]=-1;return t}return-1}function Ue(e){const t={};for(const n in e)n[0]!=="$"&&(t[n]=e[n]);return t}function Ve(e){return e==null?"":e}function g(e,t){e.appendChild(t)}function $(e,t,n){e.insertBefore(t,n||null)}function k(e){e.parentNode.removeChild(e)}function ft(e,t){for(let n=0;n<e.length;n+=1)e[n]&&e[n].d(t)}function m(e){return document.createElement(e)}function de(e){return document.createTextNode(e)}function v(){return de(" ")}function L(e,t,n,l){return e.addEventListener(t,n,l),()=>e.removeEventListener(t,n,l)}function be(e){return function(t){return t.preventDefault(),e.call(this,t)}}function d(e,t,n){n==null?e.removeAttribute(t):e.getAttribute(t)!==n&&e.setAttribute(t,n)}function Qe(e,t){const n=Object.getOwnPropertyDescriptors(e.__proto__);for(const l in t)t[l]==null?e.removeAttribute(l):l==="style"?e.style.cssText=t[l]:l==="__value"?e.value=e[l]=t[l]:n[l]&&n[l].set?e[l]=t[l]:d(e,l,t[l])}function St(e){return Array.from(e.childNodes)}function Oe(e,t){t=""+t,e.wholeText!==t&&(e.data=t)}function H(e,t,n){e.classList[n?"add":"remove"](t)}function zt(e,t,{bubbles:n=!1,cancelable:l=!1}={}){const r=document.createEvent("CustomEvent");return r.initCustomEvent(e,n,l,t),r}let _e;function fe(e){_e=e}function Ne(){if(!_e)throw new Error("Function called outside component initialization");return _e}function Et(e){Ne().$$.on_mount.push(e)}function Lt(e){Ne().$$.after_update.push(e)}function dt(){const e=Ne();return(t,n,{cancelable:l=!1}={})=>{const r=e.$$.callbacks[t];if(r){const s=zt(t,n,{cancelable:l});return r.slice().forEach(i=>{i.call(e,s)}),!s.defaultPrevented}return!0}}function Ct(e,t){const n=e.$$.callbacks[t.type];n&&n.slice().forEach(l=>l.call(this,t))}const ce=[],ge=[],ye=[],Te=[],At=Promise.resolve();let Ie=!1;function Tt(){Ie||(Ie=!0,At.then(_t))}function je(e){ye.push(e)}function Ze(e){Te.push(e)}const Ce=new Set;let ve=0;function _t(){const e=_e;do{for(;ve<ce.length;){const t=ce[ve];ve++,fe(t),It(t.$$)}for(fe(null),ce.length=0,ve=0;ge.length;)ge.pop()();for(let t=0;t<ye.length;t+=1){const n=ye[t];Ce.has(n)||(Ce.add(n),n())}ye.length=0}while(ce.length);for(;Te.length;)Te.pop()();Ie=!1,Ce.clear(),fe(e)}function It(e){if(e.fragment!==null){e.update(),J(e.before_update);const t=e.dirty;e.dirty=[-1],e.fragment&&e.fragment.p(e.ctx,t),e.after_update.forEach(je)}}const we=new Set;let U;function Pe(){U={r:0,c:[],p:U}}function qe(){U.r||J(U.c),U=U.p}function S(e,t){e&&e.i&&(we.delete(e),e.i(t))}function E(e,t,n,l){if(e&&e.o){if(we.has(e))return;we.add(e),U.c.push(()=>{we.delete(e),l&&(n&&e.d(1),l())}),e.o(t)}else l&&l()}function jt(e,t){const n={},l={},r={$$scope:1};let s=e.length;for(;s--;){const i=e[s],u=t[s];if(u){for(const o in i)o in u||(l[o]=1);for(const o in u)r[o]||(n[o]=u[o],r[o]=1);e[s]=u}else for(const o in i)r[o]=1}for(const i in l)i in n||(n[i]=void 0);return n}function xe(e,t,n){const l=e.$$.props[t];l!==void 0&&(e.$$.bound[l]=n,n(e.$$.ctx[l]))}function R(e){e&&e.c()}function P(e,t,n,l){const{fragment:r,after_update:s}=e.$$;r&&r.m(t,n),l||je(()=>{const i=e.$$.on_mount.map(ot).filter(ut);e.$$.on_destroy?e.$$.on_destroy.push(...i):J(i),e.$$.on_mount=[]}),s.forEach(je)}function q(e,t){const n=e.$$;n.fragment!==null&&(J(n.on_destroy),n.fragment&&n.fragment.d(t),n.on_destroy=n.fragment=null,n.ctx=[])}function Ot(e,t){e.$$.dirty[0]===-1&&(ce.push(e),Tt(),e.$$.dirty.fill(0)),e.$$.dirty[t/31|0]|=1<<t%31}function V(e,t,n,l,r,s,i,u=[-1]){const o=_e;fe(e);const c=e.$$={fragment:null,ctx:[],props:s,update:y,not_equal:r,bound:Ke(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(t.context||(o?o.$$.context:[])),callbacks:Ke(),dirty:u,skip_bound:!1,root:t.target||o.$$.root};i&&i(c.root);let f=!1;if(c.ctx=n?n(e,t.props||{},(a,h,...w)=>{const b=w.length?w[0]:h;return c.ctx&&r(c.ctx[a],c.ctx[a]=b)&&(!c.skip_bound&&c.bound[a]&&c.bound[a](b),f&&Ot(e,a)),h}):[],c.update(),f=!0,J(c.before_update),c.fragment=l?l(c.ctx):!1,t.target){if(t.hydrate){const a=St(t.target);c.fragment&&c.fragment.l(a),a.forEach(k)}else c.fragment&&c.fragment.c();t.intro&&S(e.$$.fragment),P(e,t.target,t.anchor,t.customElement),_t()}fe(o)}class Q{$destroy(){q(this,1),this.$destroy=y}$on(t,n){if(!ut(n))return y;const l=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return l.push(n),()=>{const r=l.indexOf(n);r!==-1&&l.splice(r,1)}}$set(t){this.$$set&&!bt(t)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}function Nt(e){let t,n,l,r,s,i,u,o=[{type:e[3]},{name:e[2]},{id:e[2]},e[4],{value:e[0]}],c={};for(let f=0;f<o.length;f+=1)c=$e(c,o[f]);return{c(){t=m("div"),n=m("label"),l=de(e[1]),r=v(),s=m("input"),d(n,"for",e[2]),Qe(s,c)},m(f,a){$(f,t,a),g(t,n),g(n,l),g(t,r),g(t,s),s.value=c.value,s.autofocus&&s.focus(),i||(u=[L(s,"input",e[5]),L(s,"keypress",e[6])],i=!0)},p(f,[a]){a&2&&Oe(l,f[1]),a&4&&d(n,"for",f[2]),Qe(s,c=jt(o,[a&8&&{type:f[3]},a&4&&{name:f[2]},a&4&&{id:f[2]},a&16&&f[4],a&1&&s.value!==f[0]&&{value:f[0]}])),"value"in c&&(s.value=c.value)},i:y,o:y,d(f){f&&k(t),i=!1,J(u)}}}function Pt(e,t,n){let{value:l=""}=t,{label:r="Input"}=t,{name:s="input"}=t,{type:i="text"}=t,{inputParams:u={}}=t;const o=dt(),c=a=>{n(0,l=a.target.value),(i==="number"||i==="range")&&n(0,l=Number(l)),o("input",l)};function f(a){Ct.call(this,e,a)}return e.$$set=a=>{"value"in a&&n(0,l=a.value),"label"in a&&n(1,r=a.label),"name"in a&&n(2,s=a.name),"type"in a&&n(3,i=a.type),"inputParams"in a&&n(4,u=a.inputParams)},[l,r,s,i,u,c,f]}class et extends Q{constructor(t){super(),V(this,t,Pt,Nt,W,{value:0,label:1,name:2,type:3,inputParams:4})}}function qt(e){let t,n,l,r,s,i,u,o;const c=e[4].default,f=yt(c,e,e[3],null);return{c(){t=m("nav"),n=m("h2"),l=de(e[0]),r=v(),s=m("hr"),i=v(),f&&f.c(),d(n,"class","svelte-15oiif1"),d(s,"class","svelte-15oiif1"),d(t,"class",u=Ve(e[2].class)+" svelte-15oiif1"),H(t,"leftShadow",e[1]=="left"),H(t,"rightShadow",e[1]=="right")},m(a,h){$(a,t,h),g(t,n),g(n,l),g(t,r),g(t,s),g(t,i),f&&f.m(t,null),o=!0},p(a,[h]){(!o||h&1)&&Oe(l,a[0]),f&&f.p&&(!o||h&8)&&kt(f,c,a,a[3],o?wt(c,a[3],h,null):$t(a[3]),null),(!o||h&4&&u!==(u=Ve(a[2].class)+" svelte-15oiif1"))&&d(t,"class",u),(!o||h&6)&&H(t,"leftShadow",a[1]=="left"),(!o||h&6)&&H(t,"rightShadow",a[1]=="right")},i(a){o||(S(f,a),o=!0)},o(a){E(f,a),o=!1},d(a){a&&k(t),f&&f.d(a)}}}function Mt(e,t,n){let{$$slots:l={},$$scope:r}=t,{title:s="Undefined"}=t,{shadow:i="left"}=t;return e.$$set=u=>{n(2,t=$e($e({},t),Ue(u))),"title"in u&&n(0,s=u.title),"shadow"in u&&n(1,i=u.shadow),"$$scope"in u&&n(3,r=u.$$scope)},t=Ue(t),[s,i,t,r,l]}class gt extends Q{constructor(t){super(),V(this,t,Mt,qt,W,{title:0,shadow:1})}}const re=[];function me(e,t=y){let n;const l=new Set;function r(u){if(W(e,u)&&(e=u,n)){const o=!re.length;for(const c of l)c[1](),re.push(c,e);if(o){for(let c=0;c<re.length;c+=2)re[c][0](re[c+1]);re.length=0}}}function s(u){r(u(e))}function i(u,o=y){const c=[u,o];return l.add(c),l.size===1&&(n=t(r)||y),u(e),()=>{l.delete(c),l.size===0&&(n(),n=null)}}return{set:r,update:s,subscribe:i}}const Se=me(-1);function ht(e,t,n){const{subscribe:l,set:r,update:s}=me(e);return{subscribe:l,set(i){i<t?i=t:i>n&&(i=n),r(i)},update(i){s(u=>(u=i(u),u<t?u=t:u>n&&(u=n),u))}}}const he=ht(10,1,50),ie=ht(10,1,20);function Dt(){const{subscribe:e,set:t,update:n}=me(new Array);return{subscribe:e,set:t,addLevel(){n(l=>[...l,Array.from({length:ae(ie)*2+1},r=>Array(ae(he)).fill(-1))])},pushLevel(l){n(r=>[...r,l])},removeLevel(l){n(r=>r.filter((s,i)=>i!==l))},setLevelCell(l,r,s,i){s!=ae(ie)&&n(u=>(u[l][s][r]=i,u))},resize(l,r){r=r*2+1,n(s=>s.map(i=>{const u=i.length-r;if(u>0)i=i.slice(u/2,i.length-u/2);else if(u<0){for(let o=0;o<-u/2;o++)i.unshift(Array(l).fill(-1));for(let o=0;o<-u/2;o++)i.push(Array(l).fill(-1))}return i=i.map(o=>(o.length>l?o=o.slice(0,l):o.length<l&&(o=[...o,...Array(l-o.length).fill(-1)]),o)),i}))},reset(){n(l=>new Array)}}}const M=Dt(),tt=localStorage.getItem("levels");if(tt){const e=JSON.parse(tt);M.set(e.levels),he.set(e.width),ie.set(e.height)}M.subscribe(e=>{localStorage.setItem("levels",JSON.stringify({width:ae(he),height:ae(ie),levels:e}))});const se=me(Array()),nt=localStorage.getItem("images");if(nt){const e=JSON.parse(nt);se.update(t=>[...t,...e.map(n=>{const l=new Image;return l.src=n.data,{name:n.name,data:l}})])}se.subscribe(e=>{localStorage.setItem("images",JSON.stringify(e.map(t=>({name:t.name,data:t.data.src}))))});const ke=me(-1),Bt="/Vivian-level-editor/assets/trash.8b6cb216.svg";function lt(e,t,n){const l=e.slice();return l[15]=t[n],l[17]=n,l}function rt(e){let t,n,l,r,s,i,u,o,c,f;return{c(){t=m("li"),n=m("input"),l=v(),r=m("label"),s=m("img"),d(n,"type","radio"),d(n,"name","tile"+String(e[17])),d(n,"id","tile"+String(e[17])),n.__value=e[17],n.value=n.__value,d(n,"class","svelte-17mgxwz"),e[12][0].push(n),Ae(s.src,i=e[15].data.src)||d(s,"src",i),d(s,"alt",u=e[15].name),d(s,"title",o=e[15].name),d(s,"class","svelte-17mgxwz"),d(r,"for","tile"+String(e[17])),d(r,"class","svelte-17mgxwz"),H(r,"current",e[3]==e[17]),d(t,"class","tileSelector__itemList__tile svelte-17mgxwz")},m(a,h){$(a,t,h),g(t,n),n.checked=n.__value===e[3],g(t,l),g(t,r),g(r,s),c||(f=L(n,"change",e[13]),c=!0)},p(a,h){h&8&&(n.checked=n.__value===a[3]),h&16&&!Ae(s.src,i=a[15].data.src)&&d(s,"src",i),h&16&&u!==(u=a[15].name)&&d(s,"alt",u),h&16&&o!==(o=a[15].name)&&d(s,"title",o),h&8&&H(r,"current",a[3]==a[17])},d(a){a&&k(t),e[12][0].splice(e[12][0].indexOf(n),1),c=!1,f()}}}function Rt(e){let t,n,l,r,s,i,u,o,c,f,a,h,w,b,X,Z,T,_,O,C,Y,N,oe,Me,ze,De,D,x,z,Be,F,K,Re,Ge,Ee,ee,G,He,ue,te,Le,Je;function pt(p){e[9](p)}let We={label:"Width:",name:"width",type:"number",inputParams:{min:0,max:100,step:1}};e[2]!==void 0&&(We.value=e[2]),b=new et({props:We}),ge.push(()=>xe(b,"value",pt)),b.$on("keypress",e[6]);function vt(p){e[10](p)}let Xe={label:"Height:",name:"height",type:"number",inputParams:{min:0,max:100,step:1}};e[1]!==void 0&&(Xe.value=e[1]),T=new et({props:Xe}),ge.push(()=>xe(T,"value",vt)),T.$on("keypress",e[6]);let ne=e[4],A=[];for(let p=0;p<ne.length;p+=1)A[p]=rt(lt(e,ne,p));return{c(){t=m("form"),n=m("div"),l=m("h3"),l.textContent="Project Manager",r=v(),s=m("button"),s.textContent="Import level set",i=v(),u=m("button"),u.textContent="Export level set",o=v(),c=m("button"),c.textContent="Delete current project",f=v(),a=m("div"),h=m("h3"),h.textContent="Grid Size",w=v(),R(b.$$.fragment),Z=v(),R(T.$$.fragment),O=v(),C=m("button"),C.textContent="Resize",Y=v(),N=m("div"),oe=m("h3"),Me=de("Tile selector : "),ze=de(e[3]),De=v(),D=m("ul"),x=m("li"),z=m("input"),Be=v(),F=m("label"),K=m("img"),Ge=v();for(let p=0;p<A.length;p+=1)A[p].c();Ee=v(),ee=m("li"),G=m("input"),He=v(),ue=m("label"),ue.textContent="+",d(l,"class","svelte-17mgxwz"),d(s,"class","svelte-17mgxwz"),d(u,"class","svelte-17mgxwz"),d(c,"class","warn svelte-17mgxwz"),d(n,"class","fileManager svelte-17mgxwz"),d(h,"class","svelte-17mgxwz"),d(C,"class","svelte-17mgxwz"),d(a,"class","gridSize svelte-17mgxwz"),d(oe,"class","svelte-17mgxwz"),d(z,"type","radio"),d(z,"name","tileEraser"),d(z,"id","tileEraser"),z.__value=-1,z.value=z.__value,d(z,"class","svelte-17mgxwz"),e[12][0].push(z),Ae(K.src,Re=Bt)||d(K,"src",Re),d(K,"alt","Eraser"),d(K,"title","Eraser"),d(K,"class","svelte-17mgxwz"),d(F,"for","tileEraser"),d(F,"class","noBg svelte-17mgxwz"),H(F,"current",e[3]==-1),d(x,"class","tileSelector__itemList__tile svelte-17mgxwz"),d(G,"type","file"),d(G,"id","newTileButton"),d(G,"accept","*.png, *.jpg, *.jpeg"),d(G,"class","svelte-17mgxwz"),d(ue,"for","newTileButton"),d(ue,"class","noBg svelte-17mgxwz"),d(ee,"class","tileSelector__itemList__tile svelte-17mgxwz"),d(D,"class","tileSelector__itemList svelte-17mgxwz"),d(N,"class","tileSelector"),d(t,"class","svelte-17mgxwz")},m(p,B){$(p,t,B),g(t,n),g(n,l),g(n,r),g(n,s),g(n,i),g(n,u),g(n,o),g(n,c),g(t,f),g(t,a),g(a,h),g(a,w),P(b,a,null),g(a,Z),P(T,a,null),g(a,O),g(a,C),g(t,Y),g(t,N),g(N,oe),g(oe,Me),g(oe,ze),g(N,De),g(N,D),g(D,x),g(x,z),z.checked=z.__value===e[3],g(x,Be),g(x,F),g(F,K),g(D,Ge);for(let le=0;le<A.length;le+=1)A[le].m(D,null);g(D,Ee),g(D,ee),g(ee,G),g(ee,He),g(ee,ue),te=!0,Le||(Je=[L(c,"click",be(e[8])),L(C,"click",be(e[7])),L(z,"change",e[11]),L(G,"change",e[14]),L(G,"change",be(e[5]))],Le=!0)},p(p,B){const le={};!X&&B&4&&(X=!0,le.value=p[2],Ze(()=>X=!1)),b.$set(le);const Ye={};if(!_&&B&2&&(_=!0,Ye.value=p[1],Ze(()=>_=!1)),T.$set(Ye),(!te||B&8)&&Oe(ze,p[3]),B&8&&(z.checked=z.__value===p[3]),(!te||B&8)&&H(F,"current",p[3]==-1),B&24){ne=p[4];let I;for(I=0;I<ne.length;I+=1){const Fe=lt(p,ne,I);A[I]?A[I].p(Fe,B):(A[I]=rt(Fe),A[I].c(),A[I].m(D,Ee))}for(;I<A.length;I+=1)A[I].d(1);A.length=ne.length}},i(p){te||(S(b.$$.fragment,p),S(T.$$.fragment,p),te=!0)},o(p){E(b.$$.fragment,p),E(T.$$.fragment,p),te=!1},d(p){p&&k(t),q(b),q(T),e[12][0].splice(e[12][0].indexOf(z),1),ft(A,p),Le=!1,J(Je)}}}function Gt(e){let t,n;return t=new gt({props:{title:"Configuration",shadow:"right",$$slots:{default:[Rt]},$$scope:{ctx:e}}}),{c(){R(t.$$.fragment)},m(l,r){P(t,l,r),n=!0},p(l,[r]){const s={};r&262175&&(s.$$scope={dirty:r,ctx:l}),t.$set(s)},i(l){n||(S(t.$$.fragment,l),n=!0)},o(l){E(t.$$.fragment,l),n=!1},d(l){q(t,l)}}}function Ht(e,t,n){let l,r,s,i;j(e,ie,_=>n(1,l=_)),j(e,he,_=>n(2,r=_)),j(e,ke,_=>n(3,s=_)),j(e,se,_=>n(4,i=_));let u;const o=()=>{let _=u[0],O=new FileReader;O.onload=()=>{const C=new Image;C.src=O.result,C.title=_.name,se.update(Y=>[...Y,{name:_.name,data:C}])},O.readAsDataURL(_)},c=_=>{_.key==="Enter"&&(f(),_.preventDefault())},f=()=>{M.resize(r,l)},a=()=>{confirm("Are you sure you want to delete this project?")&&(M.reset(),se.set([]))},h=[[]];function w(_){r=_,he.set(r)}function b(_){l=_,ie.set(l)}function X(){s=this.__value,ke.set(s)}function Z(){s=this.__value,ke.set(s)}function T(){u=this.files,n(0,u)}return[u,l,r,s,i,o,c,f,a,w,b,X,h,Z,T]}class Jt extends Q{constructor(t){super(),V(this,t,Ht,Gt,W,{})}}function Wt(e){let t,n,l,r,s,i;return{c(){t=m("div"),n=m("canvas"),d(n,"width",l=e[2]*32),d(n,"height",r=e[1]*32),d(t,"class","grid svelte-2utg53")},m(u,o){$(u,t,o),g(t,n),e[9](n),s||(i=[L(window,"resize",e[3]),L(n,"mousedown",be(e[4])),L(n,"mousemove",e[6]),L(n,"contextmenu",e[5])],s=!0)},p(u,[o]){o&4&&l!==(l=u[2]*32)&&d(n,"width",l),o&2&&r!==(r=u[1]*32)&&d(n,"height",r)},i:y,o:y,d(u){u&&k(t),e[9](null),s=!1,J(i)}}}function Xt(e,t,n){let l,r,s,i;j(e,M,_=>n(8,s=_)),j(e,se,_=>n(11,i=_));let{gridId:u}=t,o,c;const f=()=>{if(!c)return;c.clearRect(0,0,o.width,o.height);let _=Math.floor(s[u].length/2);s[u].forEach((O,C)=>{O.forEach((Y,N)=>{C==_?(c.fillStyle="black",c.fillRect(N*32,C*32,32,32)):Y===-1?(c.fillStyle="white",c.fillRect(N*32,C*32,32,32)):c.drawImage(i[Y].data,N*32,C*32,32,32)})})},a=()=>{if(c){f(),c.beginPath(),c.strokeStyle="black",c.fillStyle="black",c.lineWidth=1;for(let _=0;_<l;_++)c.moveTo(_*32,0),c.lineTo(_*32,r*32);for(let _=0;_<r;_++)c.moveTo(0,_*32),c.lineTo(l*32,_*32);c.stroke()}},h=(_,O)=>({x:Math.floor(_/o.width*l),y:Math.floor(O/o.height*r)}),w=dt(),b=_=>{if(console.log(_.buttons),_.buttons==2&&!_.shiftKey)return w("erase",h(_.offsetX,_.offsetY)),!1;if(_.buttons==1)return w("click",h(_.offsetX,_.offsetY)),!0},X=_=>{if(!_.shiftKey){_.preventDefault(),b(_);return}},Z=_=>{_.buttons==2?w("erase",h(_.offsetX,_.offsetY)):_.buttons==1&&w("click",h(_.offsetX,_.offsetY))};Et(()=>{if(c=o.getContext("2d"),!c){alert("Could not get canvas context");return}c.imageSmoothingEnabled=!0,console.log("Context loaded"),u>-1&&a()}),Lt(()=>{u>-1&&a()});function T(_){ge[_?"unshift":"push"](()=>{o=_,n(0,o)})}return e.$$set=_=>{"gridId"in _&&n(7,u=_.gridId)},e.$$.update=()=>{e.$$.dirty&384&&n(2,l=s[u][0].length),e.$$.dirty&384&&n(1,r=s[u].length),e.$$.dirty&384&&s[u]&&a()},[o,r,l,a,b,X,Z,u,s,T]}class mt extends Q{constructor(t){super(),V(this,t,Xt,Wt,W,{gridId:7})}}function Yt(e){let t;return{c(){t=m("p"),t.textContent="There is currently no level selected.",d(t,"class","center svelte-92ejb9")},m(n,l){$(n,t,l)},p:y,i:y,o:y,d(n){n&&k(t)}}}function Ft(e){let t,n,l,r,s,i;return{c(){t=m("div"),n=m("p"),n.textContent="There is currently no levels.",l=v(),r=m("button"),r.textContent="Add a new level",d(t,"class","center svelte-92ejb9")},m(u,o){$(u,t,o),g(t,n),g(t,l),g(t,r),s||(i=L(r,"click",e[2]),s=!0)},p:y,i:y,o:y,d(u){u&&k(t),s=!1,i()}}}function Kt(e){let t,n,l;return n=new mt({props:{gridId:e[0]}}),n.$on("click",e[3]),n.$on("erase",e[4]),{c(){t=m("div"),R(n.$$.fragment),d(t,"class","editor__gridContener svelte-92ejb9")},m(r,s){$(r,t,s),P(n,t,null),l=!0},p(r,s){const i={};s&1&&(i.gridId=r[0]),n.$set(i)},i(r){l||(S(n.$$.fragment,r),l=!0)},o(r){E(n.$$.fragment,r),l=!1},d(r){r&&k(t),q(n)}}}function Ut(e){let t,n,l,r;const s=[Kt,Ft,Yt],i=[];function u(o,c){return o[0]!=-1&&o[1].length>0?0:o[1].length==0?1:2}return n=u(e),l=i[n]=s[n](e),{c(){t=m("section"),l.c(),d(t,"class","editor svelte-92ejb9")},m(o,c){$(o,t,c),i[n].m(t,null),r=!0},p(o,[c]){let f=n;n=u(o),n===f?i[n].p(o,c):(Pe(),E(i[f],1,1,()=>{i[f]=null}),qe(),l=i[n],l?l.p(o,c):(l=i[n]=s[n](o),l.c()),S(l,1),l.m(t,null))},i(o){r||(S(l),r=!0)},o(o){E(l),r=!1},d(o){o&&k(t),i[n].d()}}}function Vt(e,t,n){let l,r,s;j(e,ke,c=>n(5,l=c)),j(e,Se,c=>n(0,r=c)),j(e,M,c=>n(1,s=c));const i=()=>{M.addLevel(),Se.set(s.length-1)},u=(c,f=!1)=>{console.log(c.detail,f),M.setLevelCell(r,c.detail.x,c.detail.y,f?-1:l)};return[r,s,i,u,c=>{u(c,!0)}]}class Qt extends Q{constructor(t){super(),V(this,t,Vt,Ut,W,{})}}function st(e,t,n){const l=e.slice();return l[5]=t[n],l[7]=n,l}function Zt(e){let t;return{c(){t=m("p"),t.textContent="There is currently no levels."},m(n,l){$(n,t,l)},p:y,i:y,o:y,d(n){n&&k(t)}}}function xt(e){let t,n,l=e[0],r=[];for(let i=0;i<l.length;i+=1)r[i]=it(st(e,l,i));const s=i=>E(r[i],1,1,()=>{r[i]=null});return{c(){t=m("ul");for(let i=0;i<r.length;i+=1)r[i].c();d(t,"class","levelList__list svelte-ynwbqm")},m(i,u){$(i,t,u);for(let o=0;o<r.length;o+=1)r[o].m(t,null);n=!0},p(i,u){if(u&3){l=i[0];let o;for(o=0;o<l.length;o+=1){const c=st(i,l,o);r[o]?(r[o].p(c,u),S(r[o],1)):(r[o]=it(c),r[o].c(),S(r[o],1),r[o].m(t,null))}for(Pe(),o=l.length;o<r.length;o+=1)s(o);qe()}},i(i){if(!n){for(let u=0;u<l.length;u+=1)S(r[u]);n=!0}},o(i){r=r.filter(Boolean);for(let u=0;u<r.length;u+=1)E(r[u]);n=!1},d(i){i&&k(t),ft(r,i)}}}function it(e){let t,n,l,r,s,i,u,o,c;return s=new mt({props:{gridId:e[7]}}),{c(){t=m("li"),n=m("input"),l=v(),r=m("label"),R(s.$$.fragment),i=v(),d(n,"type","radio"),d(n,"name","level"),d(n,"id","level-"+e[7]),n.__value=e[7],n.value=n.__value,d(n,"class","svelte-ynwbqm"),e[4][0].push(n),d(r,"class","levelList__list__grid svelte-ynwbqm"),d(r,"for","level-"+e[7]),d(t,"class","svelte-ynwbqm")},m(f,a){$(f,t,a),g(t,n),n.checked=n.__value===e[1],g(t,l),g(t,r),P(s,r,null),g(t,i),u=!0,o||(c=L(n,"change",e[3]),o=!0)},p(f,a){a&2&&(n.checked=n.__value===f[1])},i(f){u||(S(s.$$.fragment,f),u=!0)},o(f){E(s.$$.fragment,f),u=!1},d(f){f&&k(t),e[4][0].splice(e[4][0].indexOf(n),1),q(s),o=!1,c()}}}function en(e){let t,n,l,r,s,i,u,o;const c=[xt,Zt],f=[];function a(h,w){return h[0].length!=0?0:1}return r=a(e),s=f[r]=c[r](e),{c(){t=m("button"),t.textContent="Add a new level",n=v(),l=m("div"),s.c(),d(t,"class","svelte-ynwbqm"),d(l,"class","levelList svelte-ynwbqm")},m(h,w){$(h,t,w),$(h,n,w),$(h,l,w),f[r].m(l,null),i=!0,u||(o=L(t,"click",e[2]),u=!0)},p(h,w){let b=r;r=a(h),r===b?f[r].p(h,w):(Pe(),E(f[b],1,1,()=>{f[b]=null}),qe(),s=f[r],s?s.p(h,w):(s=f[r]=c[r](h),s.c()),S(s,1),s.m(l,null))},i(h){i||(S(s),i=!0)},o(h){E(s),i=!1},d(h){h&&k(t),h&&k(n),h&&k(l),f[r].d(),u=!1,o()}}}function tn(e){let t,n;return t=new gt({props:{title:"Level Selector",shadow:"left",$$slots:{default:[en]},$$scope:{ctx:e}}}),{c(){R(t.$$.fragment)},m(l,r){P(t,l,r),n=!0},p(l,[r]){const s={};r&259&&(s.$$scope={dirty:r,ctx:l}),t.$set(s)},i(l){n||(S(t.$$.fragment,l),n=!0)},o(l){E(t.$$.fragment,l),n=!1},d(l){q(t,l)}}}function nn(e,t,n){let l,r;j(e,M,o=>n(0,l=o)),j(e,Se,o=>n(1,r=o));const s=o=>{M.addLevel()},i=[[]];function u(){r=this.__value,Se.set(r)}return[l,r,s,u,i]}class ln extends Q{constructor(t){super(),V(this,t,nn,tn,W,{})}}function rn(e){let t,n,l,r,s,i,u,o,c;return r=new Jt({}),i=new Qt({}),o=new ln({}),{c(){t=m("header"),t.innerHTML="<h1>Vivian level Editor</h1>",n=v(),l=m("main"),R(r.$$.fragment),s=v(),R(i.$$.fragment),u=v(),R(o.$$.fragment),d(l,"class","svelte-1fszlhy")},m(f,a){$(f,t,a),$(f,n,a),$(f,l,a),P(r,l,null),g(l,s),P(i,l,null),g(l,u),P(o,l,null),c=!0},p:y,i(f){c||(S(r.$$.fragment,f),S(i.$$.fragment,f),S(o.$$.fragment,f),c=!0)},o(f){E(r.$$.fragment,f),E(i.$$.fragment,f),E(o.$$.fragment,f),c=!1},d(f){f&&k(t),f&&k(n),f&&k(l),q(r),q(i),q(o)}}}class sn extends Q{constructor(t){super(),V(this,t,null,rn,W,{})}}new sn({target:document.getElementById("app")});
